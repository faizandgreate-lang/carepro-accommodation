<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Care-Pro Riyadh Accommodation</title>
<style>
  body {font-family:"Poppins",Arial,sans-serif;margin:20px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:#222;}
  h1{text-align:center;color:#004085;font-size:28px;margin-bottom:15px;}
  table{border-collapse:collapse;width:100%;margin:15px 0;background:#fff;border-radius:6px;overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,.08)}
  th,td{border:1px solid #ddd;padding:8px 10px;text-align:left;font-size:14px;position:relative;}
  th{background:#004085;color:#fff;text-transform:uppercase;cursor:pointer;}
  tr:nth-child(even){background:#f8f9fa}
  .form{border:1px solid #ccc;padding:12px;background:#fff;border-radius:8px;margin-top:10px}
  .form input{margin:5px;padding:6px 10px;border:1px solid #bbb;border-radius:4px}
  .form button{background:#004085;color:#fff;border:none;padding:6px 10px;border-radius:4px;cursor:pointer;margin:5px}
  .hidden{display:none}
  .footer{text-align:center;margin-top:30px;color:#555;font-style:italic}
  .dropdown{display:none;position:absolute;background:#fff;border:1px solid #ccc;border-radius:4px;top:100%;left:0;z-index:10;padding:5px;max-height:200px;overflow:auto;width:150px;box-shadow:0 2px 6px rgba(0,0,0,.1);}
  .dropdown label{display:block;font-size:13px;cursor:pointer;margin:3px 0;}
  .filter-arrow::after{content:"â–¼";font-size:10px;margin-left:6px;color:#fff;}
  @media(max-width:768px){table,th,td{font-size:12px}.form input,button{width:100%;display:block}}
  .summary-chart{display:flex;gap:20px;flex-wrap:wrap;align-items:flex-start;}
  .summary-chart>.box{flex:1;min-width:300px;background:transparent;}
  #successBanner{position:fixed;top:10px;left:50%;transform:translateX(-50%);background:#28a745;color:#fff;padding:10px 20px;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,.2);font-weight:600;display:none;z-index:1000;}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div id="successBanner">âœ… All accommodation data deleted successfully!</div>

<h1>ğŸ  CARE-PRO ACCOMMODATION</h1>

<!-- === Rest of your UI stays the same === -->
<!-- (All original admin, table, summary, etc. code remains here) -->

<!-- ğŸ”‘ MASTER CONTROL BUTTONS AREA -->
<div id="masterControls" class="hidden" style="margin-top:8px;">
  <button onclick="addWorkerColumn()" style="margin:5px;padding:6px 12px;background:#004085;color:#fff;border:none;border-radius:4px;cursor:pointer;">â• Add Column</button>
  <button onclick="deleteWorkerColumn()" style="margin:5px;padding:6px 12px;background:#004085;color:#fff;border:none;border-radius:4px;cursor:pointer;">ğŸ—‘ Delete Column</button>
  <button onclick="saveWorkerColumns()" style="margin:5px;padding:6px 12px;background:#198754;color:#fff;border:none;border-radius:4px;cursor:pointer;">ğŸ’¾ Save Changes</button>
  <button onclick="deleteFullAccommodation()" style="margin:5px;padding:6px 12px;background:#dc3545;color:#fff;border:none;border-radius:4px;cursor:pointer;">ğŸ—‘ Delete Full Accommodation</button>
</div>

<!-- your existing script continues -->
<script>
const ADMIN_PASSWORD='12341234';
let isAdmin=false;
let workers=[];
let camps=[];
let campData={};
let activeFilters={};
let clientChartInstance=null;
const MASTER_PASSWORD='Care@12345';

// existing API functions, table, summary, etc... (keep all your logic intact)

// === ğŸ”¥ NEW FUNCTION: Delete Full Accommodation ===
async function deleteFullAccommodation(){
  const pw=document.getElementById('masterPw')?.value.trim();
  if(pw!==MASTER_PASSWORD){alert('âŒ Wrong master password!');return;}
  if(!confirm('âš ï¸ This will permanently delete ALL accommodation data after creating a backup. Continue?')) return;
  try{
    // create backup CSV
    const date=new Date().toISOString().split('T')[0];
    const headers=['iq','name','camp','company','gender','nationality','sponsor','room'];
    const rows=workers.map(w=>headers.map(h=>`"${(w[h]||'').replace(/"/g,'""')}"`).join(','));
    const csv=headers.join(',')+'\n'+rows.join('\n');
    const blob=new Blob([csv],{type:'text/csv'});
    const a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download=`accommodation_backup_${date}.csv`;
    a.click();
    URL.revokeObjectURL(a.href);

    // clear data
    workers=[]; camps=[]; campData={};

    // save to API
    const res=await fetch('/api/saveData',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({workers,camps,campData})
    });
    if(!res.ok) throw new Error('API error');
    const banner=document.getElementById('successBanner');
    banner.style.display='block';
    setTimeout(()=>banner.style.display='none',3000);
    renderAll();
  }catch(e){
    console.error(e);
    alert('âŒ Error deleting accommodation data!');
  }
}
</script>

</body>
</html>
